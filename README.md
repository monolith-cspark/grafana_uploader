# Grafana Dashboard Uploader 사용 설명서

본 프로그램은 로컬에서 분석된 로그 데이터(.csv 파일)를 Grafana 대시보드에 자동으로 업로드하고 관리하기 위해 사용함

## 1. 초기 설정: config.ini 파일 구성

프로그램을 실행하기 전에, Grafana 서버 연결 정보 및 API 키를 config.ini 파일의 [API] 섹션에 정확하게 입력해야 합니다.

### 1. SERVER_URL
* 접속할 Grafana 서버의 URL(포트 포함) 입력 (http://127.0.0.1:3000)

### 2. API_KEY
* Grafana에서 생성한 API Key (Admin 권한 또는 적절한 권한 필요) 입력 ( glsa_iM.... )

## 2. 기본 사용 방법

### 1. [find csv] 버튼 클릭
* 분석할 로그 파일(.csv)을 선택

### 2. [로그 분석] 버튼 클릭
* 선택된 로그 파일을 분석하여 레이스 및 시간 정보를 추출하고 업로드 버튼을 활성화

### 3. 레이스 선택
* 분석 결과 목록에서 업로드할 레이스 번호를 선택 (race는 BOARDING_IC를 기준으로 끊음)
* 지정하지 않으면 로그의 전체 범위만큼 Dashboard 설정 범위가 지정됨

### 4. Race-Start&Stop 지정
* 선택된 레이스 범위에서 섹션 이벤트를 선택하여 구체적으로 시간을 설정
* 섹션은 처음 섹션으로 변경되는 시간을 기준으로 만들어짐
* end 시간이 start보다 빠르지 않게 설정해야 에러가 발생하지 않음
* 지정하지 않는 경우 선택된 race 범위의 처음과 끝이 자동으로 설정됨


### 5. 대시보드 제목 & 차량 ID 입력
* Grafana에 생성될 대시보드의 제목을 입력
* Dash board 문서의 제목을 지정하기 위함 
* ([ID]_Title) 형태로 저장됨 ( 제목을 구분하기 위한 용도이므로 꼭 차량 ID를 맞출필요는 없음)

### 6. [Upload] 버튼 클릭
* 최종 확인 후 Grafana 서버로 대시보드 생성을 요청
* 서버 URL이나 API가 잘못되었다면 연결 테스트에서 오류가 날 수 있음
* csv는 실행파일의 csv 경로에 Title이름으로 copy되고, 복사된 csv파일을 Dashboard가 분석


## 3. 주의 사항

### 1. 대시보드 덮어쓰기 (중복 처리)

* 동작
이미 동일한 이름의 대시보드가 Grafana에 존재할 경우, 프로그램은 새로운 대시보드를 생성하는 대신 기존 대시보드를 덮어씁니다.
주의 사항 (시간 깨짐 현상): 덮어쓰기 시점에 해당 대시보드가 Grafana 웹 브라우저에서 열려있는 상태라면, 일시적으로 대시보드의 시간이 1970년 등으로 깨지는 현상이 발생할 수 있습니다.

* 해결 방법
대시보드가 열려 있는 브라우저 탭을 닫거나 뒤로 이동하여 대시보드 문서가 활성화 되지 않도록 함
프로그램으로 돌아와 다시 [Upload] 버튼을 누르면 새로운 시간 정보로 덮어쓰면서 정상화됩니다.

추가로 dash board의 시간은 정상이나 데이터가 열리지 않으면 F5로 명시적 새로고침을 해줍니다

### 2. 데이터 소스 (CSV 파일) 관리

* 데이터 소스 생성 : 업로드 시마다 CSV 데이터는 Grafana 내에 Database Source라는 항목으로 저장됩니다.
* 다중 파일 사용 : CSV 파일의 경로와 이름이 다르게 지정되면, Grafana는 이를 별개의 데이터 소스로 인식하여 여러 개의 CSV 데이터를 관리할 수 있습니다.

### 3. [Delete] 버튼 기능

* 정리 기능: [Delete] 버튼을 클릭하면, 현재 선택된 대시보드와 관련된 모든 항목을 Grafana에서 정리합니다.
    * Dashboard: 업로드했던 Grafana 대시보드 자체.
    * Database Source: 해당 대시보드가 사용했던 CSV 파일 단위의 데이터 소스.

* 용도: 너무 많이 업로드한 경우 모두 지울 때 사용


### 3. 파일 관리
* config.ini 파일 (API 등 정보 설정)
* data/grafana_dashboard_post.json 파일 (대시보드 템플릿)


